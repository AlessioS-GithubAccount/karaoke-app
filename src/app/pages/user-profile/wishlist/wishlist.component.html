<div class="wishlist-header-buttons">
  <h2>{{ 'performance_history.wishlist_title' | translate }}</h2>

  <div class="button-group">
    <a routerLink="/prenota-canzoni" class="btn-link animated-btn delay-1">
      {{ 'performance_history.go_to_booking' | translate }}
    </a>

    <button class="btn-link animated-btn delay-2" (click)="ritornaAlProfilo()">
      {{ 'performance_history.back_to_profile' | translate }}
    </button>

    <button class="btn-link animated-btn delay-3" (click)="aggiungiRiga()">
      {{ 'performance_history.add_song' | translate }}
    </button>
  </div>
</div>

<!-- SPINNER -->
<div *ngIf="isLoading" class="loading-spinner">
  <div class="spinner"></div>
  <p>{{ 'common.loading' | translate }}</p>
</div>

<!-- DESKTOP TABLE -->
<div *ngIf="!isMobile && !isLoading">
  <table class="my-zebra-table" *ngIf="wishlist.length > 0; else noWishlistDesktop">
    <thead>
      <tr>
        <th>{{ 'performance_history.song' | translate }}</th>
        <th>{{ 'performance_history.artist' | translate }}</th>
        <th>{{ 'performance_history.key' | translate }}</th>
        <th>{{ 'performance_history.actions' | translate }}</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let song of wishlist">
        <td><input class="wishlist-input" [(ngModel)]="song.canzone" /></td>
        <td><input class="wishlist-input" [(ngModel)]="song.artista" /></td>
        <td><input class="wishlist-input" [(ngModel)]="song.tonalita" /></td>
        <td>
          <div class="action-buttons">
            <button class="btn-crud" (click)="salvaWishlist(song)" [disabled]="!song.canzone || !song.artista">
              {{ 'performance_history.save_button' | translate }}
            </button>
            <button class="btn-crud" (click)="rimuoviWishlist(song.id)">
              {{ 'performance_history.delete_button' | translate }}
            </button>
          </div>
        </td>
      </tr>
    </tbody>
  </table>

  <!-- Pagination (desktop) -->
  <div class="pagination-controls" *ngIf="totalPages > 1">
    <button (click)="changePage(-1)" [disabled]="currentPage === 1">◄</button>
    <span>{{ 'performance_history.currentPage' | translate }} {{ currentPage }} / {{ totalPages }}</span>
    <button (click)="changePage(1)" [disabled]="currentPage === totalPages">►</button>
  </div>

  <ng-template #noWishlistDesktop>
    <p class="no-wishlist-text">{{ 'performance_history.wishlist_empty' | translate }}</p>
  </ng-template>
</div>

<!-- MOBILE CARDS -->
<ng-template [ngIf]="isMobile && !isLoading">
  <div *ngIf="wishlist.length > 0; else noWishlistMobile">
    <div *ngFor="let song of wishlist" class="wishlist-mobile-card">
      <div><strong>{{ 'performance_history.song' | translate }}:</strong>
        <input class="wishlist-input" [(ngModel)]="song.canzone" />
      </div>
      <div><strong>{{ 'performance_history.artist' | translate }}:</strong>
        <input class="wishlist-input" [(ngModel)]="song.artista" />
      </div>
      <div><strong>{{ 'performance_history.key' | translate }}:</strong>
        <input class="wishlist-input" [(ngModel)]="song.tonalita" />
      </div>
      <div class="mobile-card-actions">
        <button (click)="salvaWishlist(song)" [disabled]="!song.canzone || !song.artista">
          {{ 'performance_history.save_button' | translate }}
        </button>
        <button (click)="rimuoviWishlist(song.id)">
          {{ 'performance_history.delete_button' | translate }}
        </button>
      </div>
    </div>

    <!-- Pagination (mobile) -->
    <div class="pagination-controls" *ngIf="totalPages > 1">
      <button (click)="changePage(-1)" [disabled]="currentPage === 1">◄</button>
      <span>{{ 'performance_history.currentPage' | translate }} {{ currentPage }} / {{ totalPages }}</span>
      <button (click)="changePage(1)" [disabled]="currentPage === totalPages">►</button>
    </div>
  </div>

  <ng-template #noWishlistMobile>
    <p class="no-wishlist-text">{{ 'performance_history.wishlist_empty' | translate }}</p>
  </ng-template>
</ng-template>

<!-- BOTTOM ACTIONS -->
<div class="wishlist-header-buttons-2">
  <a routerLink="/prenota-canzoni" class="btn-link mt-4 btn-crud">
    {{ 'performance_history.go_to_booking' | translate }}
  </a>
  <button class="add-song-btn" (click)="aggiungiRiga()">
    {{ 'performance_history.add_song' | translate }}
  </button>
</div>

<div #bottom></div>
